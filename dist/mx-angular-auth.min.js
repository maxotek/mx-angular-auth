!function(){!function(){"use strict";angular.module("mx-angular-auth",["mx-angular-api","ngStorage"])}(),function(){function e(e,n,t,r,o){function a(e,a,c){var s=function(e){r.setJwt(e.data),t.onLogin(),a(e)},u=function(e){c(e)},l={username:e.username,password:e.password};Object.toparams=function(e){var n=[];for(var t in e)n.push(t+"="+encodeURIComponent(e[t]));return n.join("&")};var i={method:"post",url:n.tokenUrl,data:Object.toparams(l),headers:{"Content-Type":"application/x-www-form-urlencoded"}};o(i).then(s,u)}function c(){r.currentUser=null,r.setJwt(null),t.onLogout()}return{login:a,logout:c}}angular.module("mx-angular-auth").factory("mxngAccountService",e),e.$inject=["$location","Constants","$rootScope","mxngUserService","$http"]}(),function(){function e(e,n){function t(e){var n=null;null!=e&&(n=jwt_decode(e)["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"]),s.currentUser=n,s.accessToken=e,s.saveState()}function r(){n.user=angular.toJson(s.currentUser),n.accessToken=angular.toJson(s.accessToken)}function o(){var e=n.accessToken,t=jwt_decode(e),r=(new Date).getTime(),o=1e3*parseInt(t.exp);r>=o||(s.currentUser=angular.fromJson(n.user),s.accessToken=angular.fromJson(n.accessToken))}function a(){return s.restoreState(),s.currentUser}function c(){return s.restoreState(),s.accessToken}var s={currentUser:null,accessToken:null,setJwt:t,saveState:r,restoreState:o,getCurrentUser:a,getAccessToken:c};return s}angular.module("mx-angular-auth").factory("mxngUserService",e),e.$inject=["$rootScope","$localStorage"]}()}();