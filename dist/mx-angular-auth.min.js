!function(){!function(){"use strict";angular.module("mx-angular-auth",["mx-angular-api","ngStorage"])}(),function(){function e(e,n,t,r,o){function a(e,a,u){var c=function(e){r.setJwt(e.data),t.onLogin(),a(e)},s=function(e){u(e)},l={username:e.username,password:e.password};Object.toparams=function(e){var n=[];for(var t in e)n.push(t+"="+encodeURIComponent(e[t]));return n.join("&")};var i={method:"post",url:n.tokenUrl,data:Object.toparams(l),headers:{"Content-Type":"application/x-www-form-urlencoded"}};o(i).then(c,s)}function u(){r.currentUser=null,r.setJwt(null),t.onLogout()}return{login:a,logout:u}}angular.module("mx-angular-auth").factory("mxngAccountService",e),e.$inject=["$location","Constants","$rootScope","mxngUserService","$http"]}(),function(){function e(e,n){function t(e){var n=null;null!=e&&(n=jwt_decode(e)["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"]),c.currentUser=n,c.accessToken=e,c.saveState()}function r(){n.user=angular.toJson(c.currentUser),n.accessToken=angular.toJson(c.accessToken)}function o(){var e=angular.fromJson(n.accessToken);if(e){var t=jwt_decode(e),r=(new Date).getTime(),o=1e3*parseInt(t.exp);r>=o||(c.currentUser=angular.fromJson(n.user),c.accessToken=e)}}function a(){return c.restoreState(),c.currentUser}function u(){return c.restoreState(),c.accessToken}var c={currentUser:null,accessToken:null,setJwt:t,saveState:r,restoreState:o,getCurrentUser:a,getAccessToken:u};return c}angular.module("mx-angular-auth").factory("mxngUserService",e),e.$inject=["$rootScope","$localStorage"]}()}();